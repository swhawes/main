# Results {.unnumbered}

```{r install}
#| echo: false

## Install necessary packages (if not already installed)
# if (!("lme4" %in% installed.packages())) install.packages("lme4")
# if (!("lmerTest" %in% installed.packages())) install.packages("lmerTest")
# if (!("tidyverse" %in% installed.packages())) install.packages("tidyverse")
# if (!("arrow" %in% installed.packages())) install.packages("arrow")
# if (!("afex" %in% installed.packages())) install.packages("afex")
# if (!("janitor" %in% installed.packages())) install.packages("janitor")
# if (!("skimr" %in% installed.packages())) install.packages("skimr")
# if (!("sdamr" %in% installed.packages())) install.packages("sdamr")
# if (!("formatR" %in% installed.packages())) install.packages("formatR")
# if (!("report" %in% installed.packages())) install.packages("report")
# if (!("easystats" %in% installed.packages())) install.packages("easystats")
# if (!("emmeans" %in% installed.packages())) install.packages("emmeans")
# if (!("poorman" %in% installed.packages())) install.packages("poorman")
# if (!("parameters" %in% installed.packages())) install.packages("parameters")
# if (!("modelbased" %in% installed.packages())) install.packages("modelbased")
# if (!("effectsize" %in% installed.packages())) install.packages("effectsize")
# if (!("see" %in% installed.packages())) install.packages("see")
# if (!("performance" %in% installed.packages())) install.packages("performance")
# if (!("insight" %in% installed.packages())) install.packages("insight")
# if (!("DT" %in% installed.packages())) install.packages("DT")
# if (!("data.table" %in% installed.packages())) install.packages("data.table")
# if (!("arsenal" %in% installed.packages())) install.packages("arsenal")
# if (!("kableExtra" %in% installed.packages())) install.packages("kableExtra")
# if (!("equatiomatic" %in% installed.packages())) install.packages("equatiomatic")
# if (!("gtsummary" %in% installed.packages())) install.packages("gtsummary")
# if (!("ggstatsplot" %in% installed.packages())) install.packages("ggstatsplot")
# if (!("patchwork" %in% installed.packages())) install.packages("patchwork")
# if (!("papaja" %in% installed.packages())) install.packages("papaja")
```

```{r load}
#| echo: false

## Load packages
# library(lme4)
# library(lmerTest)
# library(tidyverse)
# library(arrow)
# library(afex)
# library(formatR)
# library(report)
# library(easystats)
# library(parameters)
# library(modelbased)
# library(effectsize)
# library(see)
# library(performance)
# library(insight)
# library(DT)
# library(data.table)
# library(arsenal)
# library(kableExtra)
# library(equatiomatic)
# library(gtsummary)
# library(ggstatsplot)
# library(papaja)
```

test
<!-- 
```{r config}

# Seed for random number generation
set.seed(42)

knitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, 
                      comment=NA, cache=T, code_folding=T,
                      R.options=list(width=220), fig.align='center', 
                      out.width='75%', fig.asp=.75, cache.extra = knitr::rand_seed)

```{r model}
## Load long dataframe
df_long <- read_parquet("./_data/df_long.pqt")#, lazy = TRUE)

## Linear Mixed Model with a random intercept (LMM-ri)
random_intercepts <- lmer(Aggression ~ 1 + Event + Sex + Weekly_Gaming_Hours + MatureVideoGames + (1|ids), data = df_long, REML=T)

# recall_anova <-lm(formula = Aggression ~ Weekly_Gaming_Hours, data = df_long)
# #random_intercepts <- MatureVideoGames(recall_anova, es = "pes")
# random_intercepts <- apa_print(recall_anova, es = "pes", in_paren = TRUE)

# #random_intercepts
random_intercepts


# ```

# ```{r output}
# #| code-summary: output

# ## Output and reports extending from the LMM-ri analyses
# summary(random_intercepts)
# confint(random_intercepts, level = 0.95, method = "Wald")
# report(random_intercepts)
# report_performance(random_intercepts)
# report_statistics(random_intercepts)
# random <- estimate_grouplevel(random_intercepts)
# ```

# ```{r report}
# #| code-summary: report

# df_long %>%
#   #report() %>%
#   summary()

# ## remove unused objects
# # rm(df_long_filtered)
# ```


# ```{r lavaan}
# #| include: FALSE 
# library(lavaan)
# df_long<- read_csv("./_data/df_long.csv")

# model <- ' i =~ 1*Aggression_T0 + 1*Aggression_T1 + 1*Aggression_T2
#            s =~ 0*Aggression_T0 + 1*Aggression_T1 + 2*Aggression_T2
           
# # regressions
#     i ~ MatureVideoGames*Weekly_Gaming_Hours_T0 #sex + age + edupar + incpar
#     s ~ MatureVideoGames*Weekly_Gaming_Hours_T0 #sex + age + edupar + incpar

# # time-varying covariates
#     #t1 ~ c1
#     #t2 ~ c2
#     #t3 ~ c3
#     #t4 ~ c4
# '

# fit <- growth(model, data=df_wide)
# summary(fit)





```{r}

RICLPM <- '
  # Create between components (random intercepts)
  RIx =~ 1*Weekly_Gaming_Hours_T0 + 1*Weekly_Gaming_Hours_T1 + 1*Weekly_Gaming_Hours_T2
  RIy =~ 1*Externalizing_T0 + 1*Externalizing_T1 + 1*Externalizing_T2
  
  # Create within-person centered variables
  wx0 =~ 1*Weekly_Gaming_Hours_T0
  wx1 =~ 1*Weekly_Gaming_Hours_T1
  wx2 =~ 1*Weekly_Gaming_Hours_T2 
  wy0 =~ 1*Externalizing_T0
  wy1 =~ 1*Externalizing_T1
  wy2 =~ 1*Externalizing_T2
  
  # Estimate lagged effects between within-person centered variables
  wx1 + wy1 ~ wx0 + wy0
  wx2 + wy2 ~ wx1 + wy1
  #wy2 ~ wy1
  #wy1 ~ wy0
  
  # Estimate covariance between within-person centered variables at first wave
  wx0 ~~ wy0 # Covariance
  
  # Estimate covariances between residuals of within-person centered variables 
  # (i.e., innovations)
  wx1 ~~ wy1
  wx2 ~~ wy2
  
  # Estimate variance and covariance of random intercepts
  RIx ~~ RIx
  RIy ~~ RIy
  RIx ~~ RIy

  # Estimate (residual) variance of within-person centered variables
  wx0 ~~ wx0 # Variances
  wy0 ~~ wy0
  wx1 ~~ wx1 # Residual variances
  wy1 ~~ wy1
  wx2 ~~ wx2
  wy2 ~~ wy2
  
# regressions
#RIy ~ Weekly_Gaming_Hours_T0
#s ~ Weekly_Gaming_Hours_T0 
'

RICLPM.fit <- lavaan(RICLPM, 
  data = df_wide,
  estimator ="MLR",
  #group = "MatureVideoGames",
  #ordered = c("Externalizing_T0", "Externalizing_T1", "Externalizing_T2"),
  meanstructure = T, 
  int.ov.free = T
)

#, ordered = c("Externalizing_T0", "Externalizing_T1", "Externfalizing_T2")

summary(RICLPM.fit, standardized = TRUE, fit.measures = TRUE)


``` -->

```

Externalizing Growth model indices: (x2 = .006(1), p = .93; CFI = 1; RMSEA =1)
Externalizing Growth model parameters: intercept x = .89***, var = ***; slope x = .23***, var = *

Univariate MatureVG --> Externalizing intercept = .11***(.01); Externalizing slope = -.01(.03);
Univariate GamingHrs --> Externalizing intercept = .09***(.01); Externalizing slope = -.04(.03);
Univariate Sex --> Externalizing intercept = .07***(.01); Externalizing slope = -.06(.03);

Covariates MatureVG --> Externalizing intercept = .07***(.01); Externalizing slope = .03(.03);
Covariates GamingHrs --> Externalizing intercept = .03**(.01); Externalizing slope = -.01(.02);
Covariates Sex --> Externalizing intercept = .07***(.01); Externalizing slope = -.03(.02);

FM_NoInt MatureVG --> Externalizing intercept = .05**(.01); Externalizing slope = .04(.03);
FM_NoInt GamingHrs --> Externalizing intercept = .01(.01); Externalizing slope = -.01(.03);
FM_NoInt Sex --> Externalizing intercept = .05***(.01); Externalizing slope = -.03(.02);

ThreeWayInt --> Externalizing intercept = .21(.29); Externalizing slope = .22(.76);

TwoWayInt MatureVGxGamingHrs --> Externalizing intercept = .09*(.04); Externalizing slope = -.14(.10);
TwoWayInt MatureVGxSex --> Externalizing intercept = .03(.09); Externalizing slope = -.42(-.22);
TwoWayInt GamingHrsxSex --> Externalizing intercept = .01(.05); Externalizing slope = .07(.11);

xxxx MatureVG --> Externalizing intercept = .xx(.xx); Externalizing slope = .xx(.xx);
xxxx GamingHrs --> Externalizing intercept = .xx(.xx); Externalizing slope = .xx(.xx);
xxxx Sex --> Externalizing intercept = .xx(.xx); Externalizing slope = .xx(.xx);

## Additional models we considered:
LCM-SR; RI-CLPM; Mixture models, linear growth model


|    | MVG (n = xxx)| NMVG (n = xxx) | Total (n = xxx) |
|---------|:-----|------:|:------:|
| Weekly Gaming Hrs     | 123  |   123 |  123   |
| Externalizing     | 123  |   123 |  123   |
| Aggression    | x    |     x |   x    |
| Internalizing     | 123  |   123 |  123   |
| Other    | x    |     x |   x    |
| Age      | 12   |    12 |   12   |
| Sex     | 123  |   123 |  123   |
| Race/Ethnicity    | 1    |     1 |   1    |
| White      | 12   |    12 |   12   |
| Black     | 123  |   123 |  123   |
| Hispanic    | x    |     x |   x    |
| Asian     | 123  |   123 |  123   |
| Other    | x    |     x |   x    |
| Parent Education     | 123  |   123 |  123   |
| Parent Inome    | x    |     x |   x    |
| IQ     | 123  |   123 |  123   |
| Flanker    | x    |     x |   x    |
